<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengiraan Berat Barangan</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            padding: 10px;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background-color: white;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .header-left, .header-right {
            font-weight: bold;
        }
        
        .title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.5em;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .action-button {
            padding: 5px 15px;
            background-color: #f0f0f0;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .item-container {
            margin-bottom: 10px;
        }
        
        .item-description {
            margin-bottom: 5px;
        }
        
        .item-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #333;
            border-radius: 5px;
            font-size: 1em;
        }
        
        .item-input::placeholder {
            color: #aaa;
        }
        
        .summary {
            margin-top: 15px;
            text-align: center;
            font-size: 1.2em;
        }
        
        .summary-item {
            margin: 5px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 15px;
            font-size: 0.7em;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 600px;
            border-radius: 10px;
        }
        
        .modal-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        
        .modal-table th, .modal-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        .modal-table th {
            background-color: #f2f2f2;
        }
        
        .modal-table td:first-child {
            text-align: left;
        }
        
        .modal-disclaimer {
            font-style: italic;
            font-size: 0.8em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .modal-close {
            display: block;
            margin: 0 auto;
            padding: 10px 20px;
            background-color: #f0f0f0;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left" id="current-date"></div>
            <div class="header-right" id="current-time"></div>
        </div>
        
        <div class="title">Pengiraan Berat Barangan</div>
        
        <div class="action-buttons">
            <button class="action-button" id="reset-btn">Padam</button>
            <button class="action-button" id="info-btn">Info</button>
        </div>
        
        <div id="items-container"></div>
        
        <div class="summary">
            <div class="summary-item">Jumlah Palet: <span id="total-pallets"><b>0.0</b></span></div>
            <div class="summary-item">Berat: <span id="total-weight"><b>~ 0.0</b> tan</span></div>
        </div>
        
        <div class="footer">
            (C) Ulala, All Rights Reserved. Rev 1.0, Nov-2024.
        </div>
    </div>
    
    <div id="info-modal" class="modal">
        <div class="modal-content">
            <table class="modal-table">
                <thead>
                    <tr>
                        <th>SKU</th>
                        <th>Karton/Palet</th>
                        <th>Berat(KG)/Kotak</th>
                        <th>Berat(tan)/Palet</th>
                    </tr>
                </thead>
                <tbody id="info-table-body"></tbody>
            </table>
            <div class="modal-disclaimer">
                nota: Bacaan mungkin mempunyai percanggahan kecil, untuk digunakan sebagai rujukan sahaja.
            </div>
            <button class="modal-close" id="modal-close-btn">OK</button>
        </div>
    </div>

    <script>
        // Product data
        const PRODUCT_DATA = [
            { description: "MG Air 3x200ML", cartonPerPallet: 168, weightPerCarton: 5.2 },
            { description: "MG Air 250ML", cartonPerPallet: 168, weightPerCarton: 6.5 },
            { description: "MG Air 1 LIT", cartonPerPallet: 60, weightPerCarton: 13.2 },
            { description: "MG Susu 390GM", cartonPerPallet: 48, weightPerCarton: 21.5 },
            { description: "MG Susu 500GM", cartonPerPallet: 48, weightPerCarton: 26.6 },
            { description: "MG Susu 24x390GM", cartonPerPallet: 80, weightPerCarton: 10.6 },
            { description: "MG Susu 24x500GM", cartonPerPallet: 80, weightPerCarton: 13.4 },
            { description: "MG Susu 12x1KG", cartonPerPallet: 96, weightPerCarton: 13.5 },
            { description: "MG Susu KTT 2.5KG(Pouch)", cartonPerPallet: 50, weightPerCarton: 21.1 }
        ];

        // Date and Time Formatting
        function formatDate(date) {
            const days = ['Ahad', 'Isnin', 'Selasa', 'Rabu', 'Khamis', 'Jumaat', 'Sabtu'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ogos', 'Sep', 'Okt', 'Nov', 'Dis'];
            return `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        }

        function formatTime(date) {
            let hours = date.getHours();
            let minutes = date.getMinutes();
            let seconds = date.getSeconds();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12;
            minutes = minutes < 10 ? '0' + minutes : minutes;
            seconds = seconds < 10 ? '0' + seconds : seconds;
            return `${hours}:${minutes}:${seconds} ${ampm}`;
        }

        function updateDateTime() {
            const now = new Date();
            document.getElementById('current-date').innerHTML = `<b>${formatDate(now)}</b>`;
            document.getElementById('current-time').innerHTML = `<b>${formatTime(now)}</b>`;
        }

        // Input validation
        function validateInput(input) {
            // Only allow numbers, '+', and limit to 60 characters
            return input.replace(/[^0-9+]/g, '').slice(0, 60);
        }

        // Calculate total from input string
        function calculateTotal(input) {
            try {
                // Remove any leading or trailing '+' and split by '+'
                const numbers = input.replace(/^[+]+|[+]+$/g, '').split('+')
                    .map(num => parseFloat(num.trim()) || 0);
                return numbers.reduce((sum, num) => sum + num, 0);
            } catch (error) {
                return 0;
            }
        }

        // Update summary calculations
        function updateSummary() {
            let totalPallets = 0;
            let totalWeight = 0;

            PRODUCT_DATA.forEach((product, index) => {
                const input = document.getElementById(`item-input-${index}`);
                if (input) {
                    const inputTotal = calculateTotal(input.value || '0');
                    const palletsForItem = inputTotal / product.cartonPerPallet;
                    const weightForItem = inputTotal * product.weightPerCarton / 1000; // convert to tons

                    totalPallets += palletsForItem;
                    totalWeight += weightForItem;
                }
            });

            document.getElementById('total-pallets').innerHTML = `<b>${totalPallets.toFixed(1)}</b>`;
            document.getElementById('total-weight').innerHTML = `<b>~ ${totalWeight.toFixed(1)}</b> tan`;
        }

        // Create input fields for each product
        function createInputFields() {
            const container = document.getElementById('items-container');
            container.innerHTML = '';

            PRODUCT_DATA.forEach((product, index) => {
                const itemContainer = document.createElement('div');
                itemContainer.className = 'item-container';

                const description = document.createElement('div');
                description.className = 'item-description';
                description.textContent = product.description;

                const input = document.createElement('input');
                input.type = 'text';
                input.id = `item-input-${index}`;
                input.className = 'item-input';
                input.placeholder = '(isi jumlah karton: 48 atau 50+168 atau 48+50+168)';
                input.maxLength = 60;

                // Event listeners for input
                input.addEventListener('input', (e) => {
                    e.target.value = validateInput(e.target.value);
                    updateSummary();
                });

                itemContainer.appendChild(description);
                itemContainer.appendChild(input);
                container.appendChild(itemContainer);
            });
        }

        // Create info modal content
        function createInfoModalContent() {
            const tableBody = document.getElementById('info-table-body');
            tableBody.innerHTML = '';

            PRODUCT_DATA.forEach(product => {
                const row = document.createElement('tr');
                
                const skuCell = document.createElement('td');
                skuCell.textContent = product.description;
                
                const cartonPerPalletCell = document.createElement('td');
                cartonPerPalletCell.textContent = product.cartonPerPallet;
                
                const weightPerCartonCell = document.createElement('td');
                weightPerCartonCell.textContent = product.weightPerCarton;
                
                const weightPerPalletCell = document.createElement('td');
                const weightPerPallet = (product.cartonPerPallet * product.weightPerCarton / 1000).toFixed(1);
                weightPerPalletCell.textContent = weightPerPallet;
                
                row.appendChild(skuCell);
                row.appendChild(cartonPerPalletCell);
                row.appendChild(weightPerCartonCell);
                row.appendChild(weightPerPalletCell);
                
                tableBody.appendChild(row);
            });
        }

        // Initialize the application
        function initApp() {
            // Set up date and time
            updateDateTime();
            setInterval(updateDateTime, 1000);

            // Create input fields
            createInputFields();

            // Create info modal content
            createInfoModalContent();

            // Reset button functionality
            document.getElementById('reset-btn').addEventListener('click', () => {
                document.querySelectorAll('.item-input').forEach(input => {
                    input.value = '';
                });
                updateSummary();
            });

            // Info button functionality
            const infoModal = document.getElementById('info-modal');
            const infoBtn = document.getElementById('info-btn');
            const closeBtn = document.getElementById('modal-close-btn');

            infoBtn.addEventListener('click', () => {
                infoModal.style.display = 'block';
            });

            closeBtn.addEventListener('click', () => {
                infoModal.style.display = 'none';
            });

            // Close modal if clicked outside
            window.addEventListener('click', (event) => {
                if (event.target === infoModal) {
                    infoModal.style.display = 'none';
                }
            });

            // Initial summary update
            updateSummary();
        }

        // Run initialization when page loads
        window.addEventListener('load', initApp);
    </script>
</body>
</html>
